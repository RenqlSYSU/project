MODULE LIB_NETCDF_UTIL
#ifdef UseCDF
CONTAINS

!!==================================================
SUBROUTINE NCERROR(STATUS,STRING)

USE NETCDF

IMPLICIT NONE

INTEGER,INTENT(IN) :: STATUS
CHARACTER(LEN=*),INTENT(IN),OPTIONAL :: STRING

!!====================
IF ( STATUS /= 0 ) THEN
  PRINT*, TRIM(NF90_STRERROR(STATUS))
  IF( PRESENT(STRING) ) PRINT*,TRIM(STRING)
  PRINT*,'PROGRAM STOP ! '
  STOP 10
ENDIF

END SUBROUTINE NCERROR
#endif

END MODULE LIB_NETCDF_UTIL
